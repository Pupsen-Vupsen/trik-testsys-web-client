<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru" th:charset="utf-8">
<head>
    <meta charset="UTF-8">
    <title>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—è</title>
    <link rel="icon" th:href="@{/v1/testsys/img/trik_testsys_logo.ico}">
    <link rel="stylesheet" th:href="@{/v1/testsys/css/style.css}"/>
    <link rel="stylesheet" th:href="@{/v1/testsys/css/popup.css}"/>
    <link rel="stylesheet" th:href="@{/v1/testsys/css/table.css}"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js">
    </script>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="page-type">
            <img th:src="@{/v1/testsys/img/trik_testsys_logo.svg}" alt="logo">
            <p>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—è</p>
        </div>
        <div class="exit">
            <form th:action="@{/v1/testsys}" method="get">
                <input type="submit" value="–í—ã–π—Ç–∏"/>
            </form>
        </div>
    </div>
    <div class="main">
        <div class="info">
            <div class="greeting">
                <h3>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, <span th:text="${username}"></span>!</h3>
                <p>–ù–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏:</p>
                <ul>
                    <li>–ü–æ —à–∫–æ–ª–µ;</li>
                    <li>–ü–æ —Ä–∞–π–æ–Ω—É.</li>
                </ul>
            </div>
            <div class="user-data">
                <p>–í–∞—à –ö–æ–¥-–¥–æ—Å—Ç—É–ø–∞: <b><span title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å" th:text="${accessToken}"
                                             id="accessToken" class="accessToken"
                                             onclick="copy('accessToken')"></span>.</b>
                </p>
                <p>–ö–æ–¥-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞: <b><span title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å"
                                                          th:text="${adminRegToken}"
                                                          id="adminRegToken"
                                                          class="accessToken"
                                                          onclick="copy('adminRegToken')"></span>.</b>
                </p>
            </div>
        </div>
    </div>

    <div class="table admins-table">
        <table>
            <caption>–°–ø–∏—Å–æ–∫ –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤</caption>
            <tr>
                <th>ID</th>
                <th>–ü—Å–µ–≤–¥–æ–Ω–∏–º</th>
                <th style="width: 4%">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
            <tr th:each="admin : ${admins}">
                <td th:text="${admin.id}"></td>
                <td th:text="${admin.webUser.username}"></td>
                <td>
                    <div class="popup admin-result-popup"
                         th:id="'adminResultPopup' + ${admin.id}">
                        <div class="popup-content" style="width: 80%">
                            <button class="close-button" title="–ó–∞–∫—Ä—ã—Ç—å"
                                    id="closeAdminResultPopup"
                                    th:onclick="'closeAdminResultPopup(' + ${admin.id} + ')'">
                                <i class="fa fa-close"></i>
                            </button>
                            <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö –≥—Ä—É–ø–ø –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞</h1>
                            <h1 th:text="${admin.id} + ': ' + ${admin.webUser.username}"></h1>
                            <div class="table group-results-table">
                                <table>
                                    <tr>
                                        <th>–£—á–∞—Å—Ç–Ω–∏–∫</th>
                                        <th th:each="taskName: ${adminsResult.get(admin.id).header}">
                                            <span th:text="${taskName}"></span>
                                        </th>
                                    </tr>
                                    <tr th:each="row: ${adminsResult.get(admin.id).rows}">
                                        <td th:text="${row.username}"></td>
                                        <td th:each="info: ${row.tasksInfo}" style="text-align: center">
                                            <span th:switch="${info}">
                                                <span th:case=0>‚ùå</span>
                                                <span th:case=1>‚úÖ</span>
                                                <span th:case=2>üîÑ</span>
                                                <span th:case=-1>‚¨ú</span>
                                            </span>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="popup admin-groups-popup"
                         th:id="'adminGroupsPopup' + ${admin.id}">
                        <div class="popup-content" style="width: 30%">
                            <button class="close-button" title="–ó–∞–∫—Ä—ã—Ç—å"
                                    id="closeAdminGroupsPopup"
                                    th:onclick="'closeAdminGroupsPopup(' + ${admin.id} + ')'">
                                <i class="fa fa-close"></i>
                            </button>
                            <h1>–ì—Ä—É–ø–ø—ã –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞</h1>
                            <h1 th:text="${admin.id} + ': ' + ${admin.webUser.username}"></h1>
                            <div class="table admin-groups-table">
                                <table>
                                    <tr>
                                        <th>ID</th>
                                        <th style="text-align: left">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    </tr>
                                    <tr th:each="group : ${admin.groups}">
                                        <td th:text="${group.id}"></td>
                                        <td th:text="${group.name}"></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="buttons">
                        <button class="popup-button" title="–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö –≥—Ä—É–ø–ø"
                                id="adminResults"
                                th:onclick="'showAdminResultsPopup(' + ${admin.id} + ')'">
                            <i class="fa fa-table"></i>
                        </button>
                        <button class="popup-button" title="–ì—Ä—É–ø–ø—ã –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞"
                                id="adminsGroups"
                                th:onclick="'showAdminGroupsPopup(' + ${admin.id} + ')'">
                            <i class="fa fa-users"></i>
                        </button>
                    </div>
                </td>
            </tr>

        </table>
    </div>

    <div class="table groups-table">
        <table>
            <caption>–°–ø–∏—Å–æ–∫ –ì—Ä—É–ø–ø</caption>
            <tr>
                <th style="width: 13%">ID –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞</th>
                <th style="width: 35%">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</th>
                <th style="width: 13%">ID –ì—Ä—É–ø–ø—ã</th>
                <th style="width: 35%">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th style="width: 4%">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
            <tr th:each="group : ${groups}">
                <td th:text="${group.admin.id}"></td>
                <td th:text="${group.admin.webUser.username}"></td>
                <td th:text="${group.id}"></td>
                <td th:text="${group.name}"></td>
                <td>
                    <div class="popup group-result"
                         th:id="'groupResultPopup' + ${group.id}">
                        <div class="popup-content" style="width: 80%">
                            <button class="close-button" title="–ó–∞–∫—Ä—ã—Ç—å"
                                    id="closeGroupResultPopup"
                                    th:onclick="'closeGroupResultPopup(' + ${group.id} + ')'">
                                <i class="fa fa-close"></i>
                            </button>
                            <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥—Ä—É–ø–ø—ã</h1>
                            <h1 th:text="${group.id} + ': ' + ${group.name}"></h1>
                            <div class="table group-results-table">
                                <table>
                                    <tr>
                                        <th>–£—á–∞—Å—Ç–Ω–∏–∫</th>
                                        <th th:each="taskName: ${groupsResult.get(group.id).header}">
                                            <span th:text="${taskName}" style="text-align: center"></span>
                                        </th>
                                    </tr>
                                    <tr th:each="row: ${groupsResult.get(group.id).rows}">
                                        <td th:text="${row.username}"></td>
                                        <td th:each="info: ${row.tasksInfo}" style="text-align: center">
                                            <span th:switch="${info}">
                                                <span th:case=0>‚ùå</span>
                                                <span th:case=1>‚úÖ</span>
                                                <span th:case=2>üîÑ</span>
                                                <span th:case=-1>‚¨ú</span>
                                            </span>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="popup group-members-popup"
                         th:id="'groupMembersPopup' + ${group.id}">
                        <div class="popup-content" style="width: 30%">
                            <button class="close-button" title="–ó–∞–∫—Ä—ã—Ç—å"
                                    id="closeGroupMembersPopup"
                                    th:onclick="'closeGroupMembersPopup(' + ${group.id} + ')'">
                                <i class="fa fa-close"></i>
                            </button>
                            <h1>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã</h1>
                            <h1 th:text="${group.id} + ': ' + ${group.name}"></h1>
                            <div class="table group-members-table">
                                <table>
                                    <tr>
                                        <th>ID</th>
                                        <th style="text-align: left">–ü—Å–µ–≤–¥–æ–Ω–∏–º</th>
                                    </tr>
                                    <tr th:each="student : ${group.students}">
                                        <td th:text="${student.id}"></td>
                                        <td th:text="${student.webUser.username}"></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="buttons">
                        <button class="popup-button" title="–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥—Ä—É–ø–ø—ã"
                                id="groupResults"
                                th:onclick="'showGroupResultsPopup(' + ${group.id} + ')'">
                            <i class="fa fa-table"></i>
                        </button>
                        <button class="popup-button" title="–£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã"
                                id="groupMembers"
                                th:onclick="'showGroupMembersPopup(' + ${group.id} + ')'">
                            <i class="fa fa-users"></i>
                        </button>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</div>
</body>
</html>

<script>
    function copy(id) {
        var copyText = document.getElementById(id);
        var textArea = document.createElement("textarea");

        textArea.value = copyText.textContent;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand("Copy");
        textArea.remove();
    }

    //region Scripts for group members popup
    function showGroupMembersPopup(groupId) {
        var popup = document.getElementById("groupMembersPopup" + groupId);
        popup.style.display = "block";
    }

    function closeGroupMembersPopup(groupId) {
        var popup = document.getElementById("groupMembersPopup" + groupId);
        popup.style.display = "none";
    }

    //endregion

    //region Scripts for admin groups popup
    function showAdminGroupsPopup(adminId) {
        var popup = document.getElementById("adminGroupsPopup" + adminId);
        popup.style.display = "block";
    }

    function closeAdminGroupsPopup(adminId) {
        var popup = document.getElementById("adminGroupsPopup" + adminId);
        popup.style.display = "none";
    }

    //endregion

    //region Scripts for group results popup
    function showGroupResultsPopup(groupId) {
        var popup = document.getElementById("groupResultPopup" + groupId);
        popup.style.display = "block";
    }

    function closeGroupResultPopup(groupId) {
        var popup = document.getElementById("groupResultPopup" + groupId);
        popup.style.display = "none";
    }

    //endregion

    //region Scripts for admin results popup
    function showAdminResultsPopup(adminId) {
        var popup = document.getElementById("adminResultPopup" + adminId);
        popup.style.display = "block";
    }

    function closeAdminResultPopup(adminId) {
        var popup = document.getElementById("adminResultPopup" + adminId);
        popup.style.display = "none";
    }

    //endregion

</script>

<style>

</style>